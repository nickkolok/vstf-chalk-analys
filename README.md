# Установка

Добавляем репозиторий `NodeJS` в систему:
```
curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
```

Ставим `git` и `NodeJS` в систему:
```
sudo apt-get install -y git nodejs build-essential 
```

Клонируем репозиторий:
```
git clone https://github.com/nickkolok/vstf-chalk-analys.git
```

Переходим в папку:
```
cd vstf-chalk-analys
```

Устанавливаем библиотеки-зависимости:
```
npm install
```

# Запуск

Переходим в папку:
```
cd vstf-chalk-analys
```

Запускаем анализ какой-нибудь фотки:
```
nodejs analys.js images/anyphotoname.png
```

Если говорит, что команда `nodejs` не найдена, то заменить на `node` или `js`.
Умеет жрать `png`, `jpg`, `bmp` и, возможно, что-то ещё.

Результаты будут в папке `results` в подпапке с названием, как у файла изображения.
Цифровая маркировка соответствует пороговой яркости.
Для каждой пороговой яроксти три файла:

- Два текстовыйх файла с длинами верхних и нижних иголок

- Изображение, на котором отмечены:

зелёным - центровая линия,
синим и красным - отдетектированные концы иголок.

- Изображение, на котором отмечены:

зелёным - центровая линия,
жёлтым и фиолетовым - отдетектированные концы иголок с линейно-регрессионным сглаживанием.

Если падает - то пробуем запускать вот так:

```
nodejs --max_old_space_size=8192 analys.js images/anyphotoname.png
```

Это увеличит память, доступную программе.
Вроде как работает на 64-битных системах.
Возможно, со значением 8192 придётся поиграть.
